CREATE TABLE SUPPLIERS(SUPPLIERID INT PRIMARY KEY, NAME VARCHAR(20), CONTACTINFO VARCHAR(20), ADDRESS VARCHAR(20));
CREATE TABLE PRODUCTS(PRODUCTID INT PRIMARY KEY, NAME VARCHAR(20), DESCRIPTION VARCHAR(50), SUPPLIERID INT, FOREIGN KEY(SUPPLIERID) REFERENCES SUPPLIERS(SUPPLIERID));
CREATE TABLE ORDERS(ORDERID INT PRIMARY KEY, ORDERDATE DATE, SUPPLIERID INT, FOREIGN KEY(SUPPLIERID) REFERENCES SUPPLIERS(SUPPLIERID));
CREATE TABLE ORDERDETAILS(ORDERDETAILSID INT PRIMARY KEY, ORDERID INT, FOREIGN KEY(ORDERID) REFERENCES ORDERS(ORDERID), PRODUCTID INT, FOREIGN KEY(PRODUCTID) REFERENCES PRODUCTS(PRODUCTID), QUANTITY INT, PRICE INT);
CREATE TABLE INVENTORY(INVENTORYID INT PRIMARY KEY, PRODUCTID INT, FOREIGN KEY(PRODUCTID) REFERENCES PRODUCTS(PRODUCTID), QUANTITYONHAND INT);


INSERT INTO SUPPLIERS (SUPPLIERID, NAME, CONTACTINFO, ADDRESS) VALUES (1, 'Supplier A', 'contactA@example.com', 'Address A'), (2, 'Supplier B', 'contactB@example.com', 'Address B'), (3, 'Supplier C', 'contactC@example.com', 'Address C');
INSERT INTO SUPPLIERS (SUPPLIERID, NAME, CONTACTINFO, ADDRESS) VALUES (4, 'Supplier D', 'contactD@example.com', 'Address D')
INSERT INTO PRODUCTS (ProductID, NAME, DESCRIPTION, SUPPLIERID) VALUES (1, 'Product 1', 'Description 1', 1), (2, 'Product 2', 'Description 2', 1), (3, 'Product 3', 'Description 3', 2), (4, 'Product 4', 'Description 4', 3), (5, 'Product 5', 'Description 5', 3);
INSERT INTO PRODUCTS (ProductID, NAME, DESCRIPTION, SUPPLIERID) VALUES (6, 'Product 1', 'Description 1', 1)
INSERT INTO ORDERS (ORDERID, ORDERDATE, SUPPLIERID) VALUES (1, '2024-07-01', 1), (2, '2024-07-05', 2), (3, '2024-07-10', 3), (4, '2024-07-15', 1), (5, '2024-07-20', 2);
INSERT INTO ORDERS (ORDERID, ORDERDATE, SUPPLIERID) VALUES (6, '2024-08-01', 1)
INSERT INTO ORDERS (ORDERID, ORDERDATE, SUPPLIERID) VALUES (7, '2024-08-05', 2)
INSERT INTO ORDERS (ORDERID, ORDERDATE, SUPPLIERID) VALUES (8, '2024-05-05', 2);
INSERT INTO ORDERS (ORDERID, ORDERDATE, SUPPLIERID) VALUES (9, '2024-03-05', 3)
INSERT INTO ORDERS (ORDERID, ORDERDATE, SUPPLIERID) VALUES (10, '2024-02-05', 1);
INSERT INTO ORDERDETAILS (ORDERDETAILSID, ORDERID, PRODUCTID, QUANTITY, PRICE) VALUES (1, 1, 1, 10, 100), (2, 1, 2, 5, 200), (3, 2, 3, 15, 150), (4, 3, 4, 20, 250), (5, 3, 5, 25, 300), (6, 4, 1, 10, 100), (7, 4, 3, 5, 150), (8, 5, 2, 10, 200), (9, 5, 4, 15, 250);
INSERT INTO ORDERDETAILS (ORDERDETAILSID, ORDERID, PRODUCTID, QUANTITY, PRICE) VALUES (10, 6, 1, 10, 100), (11, 7, 1, 10, 100)
INSERT INTO ORDERDETAILS (ORDERDETAILSID, ORDERID, PRODUCTID, QUANTITY, PRICE) VALUES (12, 9, 1, 10, 100);
INSERT INTO INVENTORY (INVENTORYID, PRODUCTID, QUANTITYONHAND) VALUES (1, 1, 50), (2, 2, 30), (3, 3, 20), (4, 4, 15), (5, 5, 10);

--1. LIST ALL PRODUCTS ALONG WITH TEIR SUPPLIER NAMES
SELECT P.PRODUCTID, P.NAME AS PRODUCT_NAME, P.DESCRIPTION, S.NAME AS SUPPLIER_NAME
FROM PRODUCTS P
RIGHT JOIN SUPPLIERS S ON P.SUPPLIERID = S.SUPPLIERID;

--2. GET ALL ORDERS WITH THEIR DETAILS (INCLUDING PRODUCT NAMES AND QUANTITES)
SELECT O.ORDERID, O.ORDERDATE, OD.QUANTITY, OD.PRICE, P.NAME AS PRODUCT_NAME
FROM ORDERS O
JOIN ORDERDETAILS OD ON O.ORDERID = OD.ORDERID
JOIN PRODUCTS P ON OD.PRODUCTID = P.PRODUCTID;

--3. FIND ALL SUPPLIERS WHO HAVE SUPPLIED A SPECIFIC PRODUCT (E.G., PRODUCTID = 1)
SELECT S.NAME AS SUPPLIER_NAME, S.CONTACTINFO, S.ADDRESS, P.NAME AS PRODUCT_NAME
FROM SUPPLIERS S
JOIN PRODUCTS P ON S.SUPPLIERID = P.SUPPLIERID
WHERE PRODUCTID = 1

--4. LIST ALL PRODUCTS AND THEIR CURRENT INVENTORY LEVELS
SELECT P.NAME AS PRODUCT_NAME, I.QUANTITYONHAND
FROM PRODUCTS P
JOIN INVENTORY I ON P.PRODUCTID = I.PRODUCTID

--5. FIND ALL ORDERS PLACED WITHIN THE LAST MONTH
SELECT O.ORDERID, O.ORDERDATE, OD.QUANTITY, OD.PRICE, P.NAME AS PRODUCT_NAME
FROM ORDERS O
JOIN ORDERDETAILS OD ON O.ORDERID = OD.ORDERID
JOIN PRODUCTS P ON OD.PRODUCTID = P.PRODUCTID
WHERE MONTH(ORDERDATE) = (SELECT MAX(MONTH(ORDERDATE)-1) FROM ORDERS);

select* from ORDERS;

--6. GET TOTAL QUANTITY ORDERED FOR EACH PRODUCT
SELECT P.NAME AS PRODUCT_NAME, SUM(OD.QUANTITY) AS TOTAL_QUANTITY
FROM ORDERDETAILS OD
JOIN PRODUCTS P ON OD.PRODUCTID = P.PRODUCTID
GROUP BY P.NAME;

--7. Retrieve all orders along with the total amount spent for each order
SELECT O.ORDERID, SUM(OD.QUANTITY*OD.PRICE) AS TOTAL_AMOUNT
FROM ORDERS O
JOIN ORDERDETAILS OD ON O.ORDERID = OD.ORDERID
GROUP BY O.ORDERID

--8. FIND PRODUCTS SUPPLIED BY MORE THAN ONE SUPPLIER
SELECT P.NAME AS PRODUCT_NAME, COUNT(S.SUPPLIERID) AS NUMBERS_OF_SUPPLIER
FROM PRODUCTS P
JOIN SUPPLIERS S ON P.SUPPLIERID = S.SUPPLIERID
GROUP BY P.NAME
HAVING COUNT(S.SUPPLIERID)>1

--9. GET THE AVERAGE INVENTORY LEVEL FOR EACH PRODUCT
SELECT P.NAME AS PRODUCT_NAME, AVG(I.QUANTITYONHAND) AS AVERAGE_INVENTORY
FROM PRODUCTS P
JOIN INVENTORY I ON P.PRODUCTID = I.PRODUCTID
GROUP BY P.NAME;

--10. LIST SUPPLIERS WHO HAVE NOT SUPPLIED ANY PRODUCTS
SELECT S.NAME AS SUPPLIER_NAME
FROM SUPPLIERS S
LEFT JOIN PRODUCTS P ON S.SUPPLIERID = P.SUPPLIERID
GROUP BY S.NAME
HAVING COUNT(P.PRODUCTID) = 0

